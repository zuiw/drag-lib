/**
 * @copyright
 * @file drag-lib.min.js
 * @author wuyuchen
 *
 * drag-lib.js - copyright (c) 2023-2024
 * https://github.com/zuiw/drag-lib
 *
 * This file is put on the Apache-2.0 License
 * (https://www.apache.org/licenses/LICENSE-2.0)
 */
export default class Drag{constructor(t){let e=Object.keys(t).sort(),i={};for(let r=0;r<e.length;r++)i[e[r]]=t[e[r]];return this.opraters=i,this.init(),this.makeDraggable(this.el),this}init(){for(let t in this.opraters){if("el"===t)if("string"==typeof this.opraters[t])this.el=document.querySelector(this.opraters[t]);else{if(!(this.opraters[t]instanceof HTMLElement))throw new Error("Element not found!");this.el=this.opraters[t]}let e;if(e="string"==typeof this.opraters.el?document.querySelector(this.opraters.el):this.opraters.el,"onDragStart"===t){if("function"!=typeof this.opraters[t])throw new Error("onDragStart must be a function!");{let i=this.opraters[t],r=this.onDrag;e.addEventListener("mousedown",function(t){i(t),e.addEventListener("mousemove",r)})}}if("onDrag"===t){if("function"!=typeof this.opraters[t])throw new Error("onDrag must be a function!");{let e=this.opraters[t];this.onDrag=function(t){e(t)}}}if("onDragEnd"===t){if("function"!=typeof this.opraters[t])throw new Error("onDragEnd must be a function!");{let i=this.opraters[t],r=this.onDrag;e.addEventListener("mouseup",function(t){i(t),e.removeEventListener("mousemove",r)})}}if("restrictions"===t){if("object"!=typeof this.opraters[t])throw new Error("restrictions must be an object!");this.restrictions=this.opraters[t]}}}makeDraggable(t){t.style.position="absolute";let e=this.restrictions;t.addEventListener("mousedown",function(i){if(i.preventDefault(),!e||e&&!e.x&&!e.y)var r=i.clientX-t.getBoundingClientRect().left,n=i.clientY-t.getBoundingClientRect().top;else if(e.x)r=i.clientX-t.getBoundingClientRect().left;else if(e.y)n=i.clientY-t.getBoundingClientRect().top;function o(i){if(e.width||e.height)if(e.width&&e.height){if(i.clientX-r>e.width||i.clientX-r<0||i.clientY-n>e.height||i.clientY-n<0)return}else if(e.width){if(i.clientX-r>e.width||i.clientX-r<0)return}else if(e.height&&(i.clientY-n>e.height||i.clientY-n<0))return;t.style.left=i.clientX-r+"px",t.style.top=i.clientY-n+"px"}document.addEventListener("mousemove",o),document.addEventListener("mouseup",function(){document.removeEventListener("mousemove",o)})})}makeUndraggable(t=this.opraters.el){t.outerHTML=t.outerHTML,t.style.position="static"}position(){return{x:this.opraters.el.getBoundingClientRect().left,y:this.opraters.el.getBoundingClientRect().top}}setPosition(t,e){this.opraters.el.style.left=t+"px",this.opraters.el.style.top=e+"px"}setOptions(t){for(let e in t)t.hasOwnProperty(e)&&(this.opraters[e]=t[e]);return this}};
